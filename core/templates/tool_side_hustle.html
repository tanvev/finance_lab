{% extends "base.html" %}
{% block title %}Side Hustle Planner{% endblock %}

{% block content %}
<section class="mb-6">
  <h1 class="text-3xl font-bold text-trust dark:text-blue-300">ðŸš€ Side Hustle & Career Growth Planner</h1>
  <p class="mt-2 text-gray-700 dark:text-gray-300 max-w-2xl">
    Estimate realistic earnings from side hustles, time-to-target, and choose skills that fit your schedule and goals.
  </p>
</section>

<div class="grid md:grid-cols-2 gap-6">

  <!-- INPUT -->
  <div class="bg-white dark:bg-gray-800 p-6 rounded-lg border dark:border-gray-700 shadow-sm">
    <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Tell us about you</h2>

    <label class="block text-sm mt-3">Primary skill category</label>
    <select id="skillCat" class="w-full p-2 rounded border dark:bg-gray-900 dark:border-gray-600" onchange="updateSide()">
      <option value="design">Design (UI/Graphic)</option>
      <option value="web">Web dev (HTML/CSS/JS)</option>
      <option value="data">Data (Excel / SQL / ML basics)</option>
      <option value="writing">Writing (content / blogs)</option>
      <option value="tutoring">Tutoring (academics)</option>
    </select>

    <label class="block text-sm mt-3">Hours available per week</label>
    <input id="hours" type="number" min="1" value="10" class="w-full p-2 rounded border dark:bg-gray-900 dark:border-gray-600" oninput="updateSide()">

    <label class="block text-sm mt-3">Experience level</label>
    <select id="level" class="w-full p-2 rounded border dark:bg-gray-900 dark:border-gray-600" onchange="updateSide()">
      <option value="beginner">Beginner (0-6 months)</option>
      <option value="intermediate">Intermediate (6-24 months)</option>
      <option value="pro">Pro (2+ years)</option>
    </select>

    <label class="block text-sm mt-3">Target monthly side income (â‚¹)</label>
    <input id="target" type="number" min="0" value="15000" class="w-full p-2 rounded border dark:bg-gray-900 dark:border-gray-600" oninput="updateSide()">

    <div class="mt-4 flex gap-2">
      <button class="px-4 py-2 bg-blue-600 text-white rounded" onclick="suggestPaths()">Suggest Paths</button>
      <button class="px-4 py-2 border rounded" onclick="resetSide()">Reset</button>
    </div>
  </div>

  <!-- OUTPUT -->
  <div id="sideResult" class="bg-white dark:bg-gray-800 p-6 rounded-lg border dark:border-gray-700 shadow-sm opacity-50 pointer-events-none">
    <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">Plan Summary</h2>
    <div id="planSummary" class="mt-3 text-sm text-gray-800 dark:text-gray-200"></div>

    <hr class="my-4 border-gray-200 dark:border-gray-700">

    <div id="pathSuggestions" class="text-sm text-gray-800 dark:text-gray-200"></div>

    <hr class="my-4 border-gray-200 dark:border-gray-700">

    <div id="timeEst" class="text-sm text-gray-800 dark:text-gray-200"></div>
  </div>
</div>
{% endblock %}

{% block extra_head %}
<script>
function resetSide(){
  document.getElementById('skillCat').value='design';
  document.getElementById('hours').value=10;
  document.getElementById('level').value='beginner';
  document.getElementById('target').value=15000;
  updateSide();
}

function updateSide(){
  const box = document.getElementById('sideResult');
  const salary = 0; // not used here but kept for expandability
  const skill = document.getElementById('skillCat').value;
  const hours = Number(document.getElementById('hours').value || 0);
  const level = document.getElementById('level').value;
  const target = Number(document.getElementById('target').value || 0);

  if (!hours || hours < 1) {
    box.style.opacity = '0.5'; box.style.pointerEvents = 'none';
    document.getElementById('planSummary').innerHTML = '<div class="text-xs text-gray-600 dark:text-gray-300">Enter hours to get a plan.</div>';
    return;
  }

  box.style.opacity='1'; box.style.pointerEvents='auto';

  // realistic per-hour rates by skill & level (conservative)
  const rateMap = {
    design: { beginner:150, intermediate:350, pro:800 },
    web: { beginner:200, intermediate:500, pro:1200 },
    data: { beginner:150, intermediate:400, pro:1000 },
    writing: { beginner:100, intermediate:250, pro:600 },
    tutoring: { beginner:150, intermediate:350, pro:700 }
  };
  const rate = rateMap[skill][level];

  // realistic utilization: not all hours billable - use 60% utilization
  const monthlyBillable = Math.round(hours * 4.33 * 0.6); // approx weeks to month
  const monthlyIncome = monthlyBillable * rate;

  // time to reach target
  const monthsToTarget = monthlyIncome>0 ? Math.max(1, Math.ceil(target / monthlyIncome)) : Infinity;

  document.getElementById('planSummary').innerHTML =
    `<p><strong>Estimated billable hours/month:</strong> ${monthlyBillable} hrs</p>
     <p><strong>Estimated monthly side income:</strong> â‚¹${monthlyIncome.toLocaleString()}</p>
     <p><strong>Assumed hourly rate:</strong> â‚¹${rate} (conservative)</p>`;

  // suggestions
  const paths = {
    design: [
      "Freelance UI micro-gigs (Fiverr/Upwork) â€” build 3-5 quick portfolios.",
      "Design templates (canva/store) â€” passive sales.",
      "Short contract with startups for 10â€“20 hours/month."
    ],
    web: [
      "Small websites for local businesses (â‚¹6kâ€“15k each).",
      "Freelance frontend fixes & landing pages hourly.",
      "Build a simple product and sell templates."
    ],
    data: [
      "Excel consultancy: automate sheets for small shops.",
      "Dashboard creation gigs using Google Sheets/Power BI.",
      "Basic ML projects for internships / freelance."
    ],
    writing: [
      "Blog/SEO content writing for startups.",
      "Create niche newsletters with paid subscribers.",
      "Micro-copy & product description gigs."
    ],
    tutoring: [
      "1:1 online tutoring (â‚¹200â€“800/hr).",
      "Group batch classes (higher leverage).",
      "Micro-courses & recorded lessons."
    ]
  };

  let suggestionHtml = `<p class="font-semibold">Suggested Paths</p><ul class="mt-2 space-y-1">`;
  paths[skill].forEach(p => suggestionHtml += `<li>â€¢ ${p}</li>`);
  suggestionHtml += `</ul>`;
  document.getElementById('pathSuggestions').innerHTML = suggestionHtml;

  document.getElementById('timeEst').innerHTML =
    `<p><strong>To reach â‚¹${target.toLocaleString()}:</strong> ~ <strong>${monthsToTarget}</strong> month(s) at this pace.</p>
     <p class="text-xs mt-2 text-gray-600 dark:text-gray-300">Tip: Increase billable hours, raise rates via specialization, or productize (templates/courses) to scale faster.</p>`;
}

// helper to suggest specific paths quickly
function suggestPaths(){ updateSide(); document.getElementById('sideResult').scrollIntoView({behavior:'smooth'}); }

// initialize
document.addEventListener('DOMContentLoaded', () => { updateSide(); });
</script>
{% endblock %}
